name: ğŸ” Monitoramento DiÃ¡rio

on:
  schedule:
    # Roda todo dia Ã s 9h (horÃ¡rio UTC = 6h BrasÃ­lia)
    - cron: '0 9 * * *'
  workflow_dispatch: # Permite execuÃ§Ã£o manual

jobs:
  health-check:
    name: ğŸ¥ Health Check E2E
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4

      - name: ğŸ“¦ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: ğŸ“š Instalar dependÃªncias
        run: npm ci

      - name: ğŸ­ Instalar Playwright
        run: npx playwright install --with-deps chromium

      - name: ğŸ§ª Rodar testes crÃ­ticos
        run: |
          npx playwright test --grep "@smoke" || true
        env:
          BASE_URL: https://poderosa.netlify.app

      - name: ğŸ“Š Gerar relatÃ³rio
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: daily-health-check
          path: playwright-report/

      - name: ğŸš¨ Notificar se houver falhas
        if: failure()
        run: |
          echo "âš ï¸ Health check falhou!"
          echo "Sistema pode estar com problemas."
          # Aqui vocÃª pode adicionar integraÃ§Ã£o com Slack, Discord, etc.
